(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-565fe291"],{1197:function(t,e,r){"use strict";var n=r("299c9"),i=r.n(n);i.a},"299c9":function(t,e,r){},4050:function(t,e,r){},5710:function(t,e,r){"use strict";r("96cf");var n=r("3b8d"),i=r("6c47");e["a"]={mixins:[i["a"]],inject:["libraryContentEventBus"],watch:{libraryId:{handler:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e>0)){t.next=5;break}if(t.t0=this.initComponent,!t.t0){t.next=5;break}return t.next=5,this.initComponent();case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),immediate:!0}},created:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.initEventBus&&this.initEventBus(this.libraryContentEventBus);case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{initEventBus:function(t){},initComponent:function(){}}}},b1ca:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"c-library-drawer-doc-historys bold-normal"},[r("el-drawer",{attrs:{title:t.title,visible:t.visibleDrawer,"custom-class":"content-drawer",size:"400px","modal-append-to-body":!1},on:{"update:visible":function(e){t.visibleDrawer=e}}},[r("div",{staticClass:"content-drawer__content"},[r("el-scrollbar",{staticStyle:{height:"calc(100vh - 110px)"}},[r("c-infinite-list",{ref:"list",attrs:{request:t.getLibraryDocHistoryList,"empty-tip":"暂无历史"}},[r("ul",t._l(t.docHistoryList,(function(e){return r("li",{key:e.id,staticClass:"version-item"},[r("div",[r("span",{staticClass:"version-item__name"},[t._v(t._s(t._f("dateFormat")(e.create_time,"m-d H:i:s")))]),r("span",{staticClass:"version-item__user"},[t._v(t._s(e.user_info.nickname))])]),r("el-button",{attrs:{type:"text"},on:{click:function(r){return t.onDocHistoryRecovery(e)}}},[t._v("恢复")])],1)})),0)])],1)],1)])],1)},i=[],s=(r("8e6e"),r("ac6a"),r("456d"),r("bd86")),a=(r("96cf"),r("3b8d")),o=r("cc2f"),c=r("5710");function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach((function(e){Object(s["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var f={name:"c-library-drawer-doc-historys",mixins:[o["a"],c["a"]],computed:{title:function(){return"文档内容历史"}},data:function(){return{docId:0,searchKey:"",docHistoryList:[]}},methods:{initEventBus:function(t){var e=this;t.$on("doc-history",(function(t){var r=t.docId;e.visibleDrawer=!0,e.docId=r}))},getLibraryDocHistoryList:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e,r){var n,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={},t.next=3,this.$api.v1.LibraryDocHistoryList(l(l({},e),{},{library_id:this.libraryId,library_doc_id:this.docId})).then((function(t){var e=t.resData,r=t.res;i.$utils.ArrayConcat(i.docHistoryList,e.list),n=r}));case 3:r(n);case 4:case"end":return t.stop()}}),t,this)})));function e(e,r){return t.apply(this,arguments)}return e}(),getDocHistoryInfo:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var r,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=!1,t.next=3,this.$api.v1.LibraryDocHistoryInfo({library_id:this.libraryId,doc_history_id:e},{loading:function(t){n.libraryManagerLoading=t}}).then((function(t){var e=t.resData;r=e}));case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),onDrawerOpen:function(){this.onDocHistoryListFlush()},onDocHistoryListFlush:function(){var t=this;this.docHistoryList=[],this.$nextTick((function(){t.$refs.list.initList()}))},onDocHistoryRecovery:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.visibleDrawer=!1,t.next=3,this.getDocHistoryInfo(e.id);case 3:if(r=t.sent,r){t.next=7;break}return this.$tip.error("文档历史不存在"),t.abrupt("return",!1);case 7:this.libraryContentEventBus.$emit("doc-history-recovery",r);case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},components:{"c-infinite-list":function(){return r.e("chunk-bcdc11c6").then(r.bind(null,"3246"))}}},h=f,d=(r("1197"),r("d4ac"),r("2877")),p=Object(d["a"])(h,n,i,!1,null,"4619eb68",null);e["default"]=p.exports},cc2f:function(t,e,r){"use strict";e["a"]={props:{visible:{type:Boolean,default:!1}},watch:{visible:function(t){this.visibleDrawer=t},visibleDrawer:function(t){this.$emit("update:visible",t),t?this.onDrawerOpen&&this.onDrawerOpen():this.$emit("close",this.$data)}},data:function(){return{visibleDrawer:this.visible,loadingDrawer:!1}}}},d4ac:function(t,e,r){"use strict";var n=r("4050"),i=r.n(n);i.a}}]);
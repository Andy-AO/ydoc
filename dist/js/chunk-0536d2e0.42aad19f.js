(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0536d2e0"],{"3fee":function(r,e,t){"use strict";t.r(e);var a=function(){var r=this,e=r.$createElement,t=r._self._c||e;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:r.pageLoading,expression:"pageLoading"}],staticClass:"page-library-create"},[t("el-card",{attrs:{shadow:"hover"}},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",{staticClass:"title"},[r._v("创建文档库")])]),t("div",{staticClass:"form-body"},[t("el-form",{ref:"library",attrs:{model:r.library,rules:r.libraryRuels,"label-position":"right","label-width":"80px"},nativeOn:{submit:function(r){r.preventDefault()}}},[t("el-form-item",{attrs:{label:"库名称",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入文档库名称，3~32个字符",clearable:""},model:{value:r.library.name,callback:function(e){r.$set(r.library,"name",e)},expression:"library.name"}})],1),t("el-form-item",{attrs:{label:"库分组",prop:"group"}},[t("el-select",{attrs:{placeholder:"请选择文档库分组",clearable:""},model:{value:r.library.group_id,callback:function(e){r.$set(r.library,"group_id",e)},expression:"library.group_id"}},r._l(r.libraryGroups,(function(r){return t("el-option",{key:r.id,attrs:{label:r.name,value:r.id}})})),1),t("el-button",{staticClass:"create-library-group",attrs:{icon:"el-icon-plus",plain:""},on:{click:r.onCreateLibraryGroup}},[r._v("\n                        新增分组\n                    ")])],1),t("el-form-item",{attrs:{label:"库简介",prop:"desc"}},[t("el-input",{attrs:{type:"textarea",resize:"none",rows:"4",placeholder:"文档库简介，用于介绍文档库的基本信息，字数在255个字符之内"},model:{value:r.library.desc,callback:function(e){r.$set(r.library,"desc",e)},expression:"library.desc"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",loading:r.submitLoading},on:{click:r.onCreateLibrary}},[r._v("立即创建")]),t("el-button",{attrs:{type:"danger"},on:{click:r.onResetLibrary}},[r._v("重置")])],1)],1),t("div",{staticClass:"library-cover"},[t("el-upload",{staticClass:"library-cover__upload",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","show-file-list":!1,"http-request":r.handlerLibraryCoverUpload}},[r.library.cover?t("img",{staticClass:"avatar",attrs:{src:r.library.cover}}):t("i",{staticClass:"el-icon-plus library-cover__upload-icon"})]),t("div",{staticClass:"library-cover__operate"},[t("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-refresh",loading:r.libraryCoverLoading,plain:""},on:{click:r.onRandomImage}},[r._v("随机生成封面\n                    ")])],1)],1)],1)]),t("c-library-group-modal",{attrs:{visible:r.groupModal.visible,"group-id":r.groupModal.groupId},on:{"update:visible":function(e){return r.$set(r.groupModal,"visible",e)},"group-save-success":r.onLibraryGroupSaveSuccess}})],1)},i=[],n=(t("7f7f"),t("96cf"),t("3b8d")),s=t("68c7"),o={name:"page-library-create",mixins:[s["a"]],components:{"c-library-group-modal":function(){return t.e("chunk-b79d74b0").then(t.bind(null,"8a5a"))}},data:function(){return{libraryRuels:{name:[{required:!0,message:"请输入文档库名称",trigger:"blur"}]},library:{name:"",group_id:"",desc:"",cover:""},libraryGroups:[],submitLoading:!1,groupModal:{visible:!1,groupId:0},libraryCoverLoading:!1}},created:function(){var r=Object(n["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return this.pageLoading=!0,r.next=3,this.initLibraryGroups();case 3:this.onRandomImage(),this.pageLoading=!1;case 5:case"end":return r.stop()}}),r,this)})));function e(){return r.apply(this,arguments)}return e}(),methods:{initLibraryGroups:function(){var r=Object(n["a"])(regeneratorRuntime.mark((function r(){var e;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e=[],r.next=3,this.$api.v1.LibraryGroupCollection().then((function(r){var t=r.resData;e=t}));case 3:this.libraryGroups=e;case 4:case"end":return r.stop()}}),r,this)})));function e(){return r.apply(this,arguments)}return e}(),submitCreateLibrary:function(){var r=Object(n["a"])(regeneratorRuntime.mark((function r(){var e=this;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,this.checkValidate("library");case 2:return r.next=4,this.$api.v1.LibraryCreate(this.library,{loading:function(r){e.submitLoading=r}}).then((function(r){r.resMsg;e.$notify.success({title:"创建文档库",message:e.library.name}),e.$link.home()}));case 4:case"end":return r.stop()}}),r,this)})));function e(){return r.apply(this,arguments)}return e}(),handlerLibraryCoverUpload:function(r){var e=this,t=r.file,a=new FormData;a.append("file",t),this.$api.v1.ToolsImageUpload(a,{loading:function(r){e.libraryCoverLoading=r},report:!0}).then((function(r){var t=r.resData;e.library.cover=t.url})).catch((function(r){var t=r.resMsg;e.$utils.tip("上传失败："+t)}))},onCreateLibraryGroup:function(){this.groupModal.visible=!0},onCreateLibrary:function(){this.submitCreateLibrary()},onResetLibrary:function(){this.resetValidate("library")},onLibraryGroupSaveSuccess:function(){this.initLibraryGroups()},onRandomImage:function(){var r=this;this.$api.v1.ToolsImageRandomTmp({key:this.library.name},{loading:function(e){r.libraryCoverLoading=e}}).then((function(e){var t=e.resData;r.library.cover=t.url}))}}},l=o,c=(t("d074"),t("d22a"),t("2877")),u=Object(c["a"])(l,a,i,!1,null,"640a7041",null);e["default"]=u.exports},"68c7":function(r,e,t){"use strict";t("96cf");var a=t("3b8d");e["a"]={data:function(){return{pageLoading:!0,pageFirstInited:!1}},methods:{checkValidate:function(){var r=Object(a["a"])(regeneratorRuntime.mark((function r(e){var t;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!this.$refs||!this.$refs[e]){r.next=5;break}return r.next=3,this.$refs[e].validate();case 3:return t=r.sent,r.abrupt("return",t);case 5:return r.abrupt("return",!1);case 6:case"end":return r.stop()}}),r,this)})));function e(e){return r.apply(this,arguments)}return e}(),resetValidate:function(r){this.$refs&&this.$refs[r]&&this.$refs[r].resetFields()},loadaction:function(){var r=Object(a["a"])(regeneratorRuntime.mark((function r(e,t){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return this[t]=!0,r.next=3,e();case 3:return a=r.sent,this[t]=!1,r.abrupt("return",a);case 6:case"end":return r.stop()}}),r,this)})));function e(e,t){return r.apply(this,arguments)}return e}()}}},7515:function(r,e,t){},cecc:function(r,e,t){},d074:function(r,e,t){"use strict";var a=t("7515"),i=t.n(a);i.a},d22a:function(r,e,t){"use strict";var a=t("cecc"),i=t.n(a);i.a}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3914bae7"],{"031d":function(e,t,s){"use strict";var a=s("379f"),i=s.n(a);i.a},"379f":function(e,t,s){},6556:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}],staticClass:"page-user-message",attrs:{"element-loading-text":"处理中"}},[s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:7}},[s("el-card",{attrs:{shadow:"hover"}},[s("div",{staticClass:"message-list-operate"},[s("el-input",{staticClass:"message-list-operate__input",attrs:{size:"mini",placeholder:"搜索消息",clearable:""},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}},[s("el-select",{staticClass:"message-list-operate__select",attrs:{slot:"prepend",placeholder:"请选择"},on:{change:e.onSearch},slot:"prepend",model:{value:e.searchStatus,callback:function(t){e.searchStatus=t},expression:"searchStatus"}},[s("el-option",{attrs:{label:"全部("+e.messageCount["-1"]+")",value:"-1"}}),s("el-option",{attrs:{label:"未读("+e.messageCount[0]+")",value:"0"}}),s("el-option",{attrs:{label:"已读("+e.messageCount[1]+")",value:"1"}})],1),s("el-button",{attrs:{slot:"append",loading:e.messageListLoading,icon:"el-icon-search"},on:{click:e.onSearch},slot:"append"})],1),s("el-dropdown",{attrs:{calss:"message-list-operate__more",trigger:"hover",placement:"bottom"},on:{command:e.onMessageListOperate}},[s("span",{staticClass:"el-dropdown-link"},[s("i",{staticClass:"el-icon-more",attrs:{title:"更多操作"}})]),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"allRead"}},[s("i",{staticClass:"el-icon-view"}),e._v(" 全部已读\n                            ")]),s("el-dropdown-item",{attrs:{command:"refresh"}},[s("i",{staticClass:"el-icon-refresh"}),e._v(" 刷新列表\n                            ")])],1)],1)],1),s("el-scrollbar",{staticClass:"scrollbar"},[s("c-infinite-list",{ref:"messageList",attrs:{request:e.getMessageList,"empty-tip":"暂无消息"}},[s("ul",{staticClass:"message-list"},e._l(e.messageList,(function(t){return s("li",{key:t.id,staticClass:"message-item",class:t.id===e.activeMessage?"active":"",on:{click:function(s){return e.onMessageView(t)}}},[s("div",{staticClass:"message-item__header"},[s("div",{staticClass:"message-item__header-title text-overflow"},[e._v("\n                                        "+e._s(t.title)+"\n                                    ")]),s("div",{staticClass:"message-item__header-status"},[s("el-tag",{directives:[{name:"show",rawName:"v-show",value:!t.status,expression:"!message.status"}],attrs:{size:"mini",type:"danger"}},[e._v("未读")])],1)]),s("div",{staticClass:"message-item__footer"},[s("div",{staticClass:"message-item__footer-date"},[s("i",{staticClass:"el-icon-time"}),e._v(" "+e._s(e._f("dateFormat")(t.create_time))+"\n                                    ")])])])})),0)])],1)],1)],1),s("el-col",{attrs:{span:17}},[s("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.messageViewLoading,expression:"messageViewLoading"}],attrs:{shadow:"hover","element-loading-text":"读取中..."}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.isMessageView,expression:"isMessageView"}],staticClass:"message-view"},[s("p",{staticClass:"message-view__title"},[e._v(e._s(e.messageView.title))]),s("p",{staticClass:"message-view__date"},[s("i",{staticClass:"el-icon-time"}),e._v(" "+e._s(e._f("dateFormat")(e.messageView.create_time)))]),s("div",{staticClass:"message-view__content"},[e._v(e._s(e.messageView.content))])]),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.isMessageView,expression:"!isMessageView"}],staticClass:"message-view-empty"},[s("div",{staticClass:"message-view-empty__tip"},[e._v(" ^ ^ 欢迎使用YDOC~ ")])])])],1)],1)],1)},i=[],n=(s("8e6e"),s("ac6a"),s("456d"),s("bd86")),r=(s("96cf"),s("3b8d")),o=s("68c7");function c(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function l(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?c(Object(s),!0).forEach((function(t){Object(n["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var u={name:"page-user-message",components:{"c-infinite-list":function(){return s.e("chunk-bcdc11c6").then(s.bind(null,"3246"))}},mixins:[o["a"]],computed:{isMessageView:function(){return this.messageView.id>0&&this.messageView},messageIndexCollection:function(){var e={};return this.$utils.ForEach(this.messageList,(function(t,s){e[t.id]=s})),e}},data:function(){return{searchStatus:"-1",searchKey:"",activeMessage:"",messageList:[],messageListLoading:!1,messageView:{},messageViewLoading:!1,messageCount:{"-1":0,0:0,1:0},pageLoading:!1}},created:function(){this.initMessageAcountAll()},methods:{getMessageList:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,s){var a,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a={},1!==t.page_num){e.next=4;break}return e.next=4,this.getMessageCountByStatus(this.searchStatus);case 4:return e.next=6,this.$api.v1.UserMessageList(l(l({},t),{},{search_status:this.searchStatus,search_key:this.searchKey}),{loading:function(e){i.messageListLoading=e}}).then((function(e){var t=e.resData,s=e.res;i.$utils.ArrayConcat(i.messageList,t.list),a=s}));case 6:s(a);case 7:case"end":return e.stop()}}),e,this)})));function t(t,s){return e.apply(this,arguments)}return t}(),handleMessageRead:function(e){this.messageList[this.messageIndexCollection[e]].status=1,this.initMessageAcountAll()},handlerMessageReadAll:function(){var e=this;this.$api.v1.UserMessageReadAll({},{loading:function(t){e.pageLoading=t}}).then((function(){e.$utils.ForEach(e.messageList,(function(e){e.status=1})),e.initMessageAcountAll()}))},handleMessageRemove:function(e){this.messageList.splice(this.messageIndexCollection[e],1)},getMessageCountByStatus:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t>>=0,e.next=3,this.$api.v1.UserMessageCount({status:t},{loading:function(e){s.messageListLoading=e}}).then((function(e){var a=e.resData;s.messageCount[t]=a.count}));case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),initMessageAcountAll:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$api.v1.UserMessageCountAll({},{loading:function(e){t.messageListLoading=e}}).then((function(e){var s=e.resData;t.messageCount=s,s[0]>>0===0&&t.$store.commit("global/setUserMessageUnreadCount",0)}));case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onMessageListOperate:function(e){switch(e){case"allRead":this.handlerMessageReadAll();break;case"refresh":this.onSearch();break}},onMessageView:function(e){var t=this,s=e.id;if(this.activeMessage===s)return this.activeMessage="",this.messageView={},!0;this.activeMessage=s,this.$api.v1.UserMessageInfo({message_id:e.id},{loading:function(e){t.messageViewLoading=e}}).then((function(s){var a=s.resData;t.messageView=a,t.handleMessageRead(e.id)}))},onSearch:function(){this.messageList=[],this.$refs.messageList.initList()},onRemove:function(e){var t=this;this.$api.v1.UserMessageRemove({message_id:e.id},{loading:function(e){t.pageLoading=e}}).then((function(s){s.resData;t.$tip.success("删除成功"),t.handleMessageRemove(e.id)}))}}},g=u,d=(s("7fdd"),s("031d"),s("2877")),m=Object(d["a"])(g,a,i,!1,null,"350182bf",null);t["default"]=m.exports},"68c7":function(e,t,s){"use strict";s("96cf");var a=s("3b8d");t["a"]={data:function(){return{pageLoading:!0,pageFirstInited:!1}},methods:{checkValidate:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.$refs||!this.$refs[t]){e.next=5;break}return e.next=3,this.$refs[t].validate();case 3:return s=e.sent,e.abrupt("return",s);case 5:return e.abrupt("return",!1);case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),resetValidate:function(e){this.$refs&&this.$refs[e]&&this.$refs[e].resetFields()},loadaction:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,s){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this[s]=!0,e.next=3,t();case 3:return a=e.sent,this[s]=!1,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));function t(t,s){return e.apply(this,arguments)}return t}()}}},"7fdd":function(e,t,s){"use strict";var a=s("ece7"),i=s.n(a);i.a},ece7:function(e,t,s){}}]);